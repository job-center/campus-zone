<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,user-scalable=0,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="format-detection" content="telephone=no" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="apple-mobile-web-app-capable" content="yes">
<title>宠物列表</title>
<link href="css/style.css" rel="stylesheet" type="text/css" />
<style>
html,body {height: 100%;overflow: hidden}
</style>

</head>
<body>
    <div class="mui-content">
        <div id='list' class="mui-group-list">
            <div class="mui-group-list-search mui-input-row mui-search" style="display: none;">
                <input id="input_search" type="search" class="mui-input-clear mui-group-list-search-input" placeholder="搜索">
            </div>
            <div class="mui-group-list-bar">
                <a>A</a>
                <a>B</a>
                <a>C</a>
                <a>D</a>
                <a>E</a>
                <a>F</a>
                <a>G</a>
                <a>H</a>
                <a>I</a>
                <a>J</a>
                <a>K</a>
                <a>L</a>
                <a>M</a>
                <a>N</a>
                <a>O</a>
                <a>P</a>
                <a>Q</a>
                <a>R</a>
                <a>S</a>
                <a>T</a>
                <a>U</a>
                <a>V</a>
                <a>W</a>
                <a>X</a>
                <a>Y</a>
                <a>Z</a>
            </div>
            <div class="mui-group-list-alert"></div>
            <div class="mui-group-list-inner">
                <div class="mui-group-list-empty-alert">没有数据</div>
                <ul id="ul_pet" class="mui-table-view">
                    <li data-group="A" class="mui-table-view-divider mui-group-list-group">A</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">A狗</li>-->
                    
                    <li data-group="B" class="mui-table-view-divider mui-group-list-group">B</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">B狗</li>-->
                    <!--<li class="mui-table-view-cell mui-group-list-item">B狗</li>-->
                    <!--<li class="mui-table-view-cell mui-group-list-item">B狗</li>-->
                    
                    <li data-group="C" class="mui-table-view-divider mui-group-list-group">C</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">C狗</li>-->
                    
                    <li data-group="D" class="mui-table-view-divider mui-group-list-group">D</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">D狗</li>-->
                    
                    <li data-group="E" class="mui-table-view-divider mui-group-list-group">E</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">E狗</li>-->
                    <!--<li class="mui-table-view-cell mui-group-list-item">E狗</li>-->
                    <!--<li class="mui-table-view-cell mui-group-list-item">E狗</li>-->
                    
                    <li data-group="F" class="mui-table-view-divider mui-group-list-group">F</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="G" class="mui-table-view-divider mui-group-list-group">G</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="H" class="mui-table-view-divider mui-group-list-group">H</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="J" class="mui-table-view-divider mui-group-list-group">J</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="K" class="mui-table-view-divider mui-group-list-group">K</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="L" class="mui-table-view-divider mui-group-list-group">L</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="M" class="mui-table-view-divider mui-group-list-group">M</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="N" class="mui-table-view-divider mui-group-list-group">N</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="P" class="mui-table-view-divider mui-group-list-group">P</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="Q" class="mui-table-view-divider mui-group-list-group">Q</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="R" class="mui-table-view-divider mui-group-list-group">R</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="S" class="mui-table-view-divider mui-group-list-group">S</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="T" class="mui-table-view-divider mui-group-list-group">T</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="W" class="mui-table-view-divider mui-group-list-group">W</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="X" class="mui-table-view-divider mui-group-list-group">X</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="Y" class="mui-table-view-divider mui-group-list-group">Y</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                    
                    <li data-group="Z" class="mui-table-view-divider mui-group-list-group">Z</li>
                    <!--<li class="mui-table-view-cell mui-group-list-item">F狗</li>-->
                </ul>
            </div>
        </div>
    </div>
    <div class="ui-dialog" style="display:none">
        <div class="ui-dialog-cnt">
            <div class="ui-dialog-hd" id="div_text">请选择服务项目</div>
            <div class="ui-dialog-ft">
                <button type="button" data-role="button" id="button_confirm">确定</button>
            </div>
        </div>
    </div>
</body>
<script src="js/mui.min.js"></script>
<script src="js/mui.indexedlist.js"></script>
<script type="text/javascript" src="js/jquery.min.js" ></script>
<script type="text/javascript">
    $(function(){

        $.ajax({
            url:'/animal/listAllAnimals',
            type:'GET',
            async:false,
            success:function(result){
                $("li.mui-table-view-cell.mui-group-list-item").remove();
                if(result.success){
                    $.each(result.data,function(index,item){
                        var type = item.orderType;
                        $("li[data-group='"+type+"']").after("<li value='"+item.id+"' class='mui-table-view-cell mui-group-list-item'>"+item.animalsName+"</li>");
                    })
                } else{
                    $("#div_text").text(result.detail);
                    $(".ui-dialog").show();
                }
            },failure:function(){
//				alert("系统错误");
                $("#div_text").text("系统错误！")
                $(".ui-dialog").show();
            }
        });

        function GetRequest() {
            var url = location.search; //获取url中"?"符后的字串
            var theRequest = new Object();
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                var strs = str.split("&");
                for(var i = 0; i < strs.length; i ++) {
                    theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
                }
            }
            return theRequest;
        }

        var requestParam = GetRequest();
        var ru = requestParam.ru;
        var startDate = requestParam.startDate;
        var endDate = requestParam.endDate;
        var course_id = requestParam.course_id;

        mui.init();
        mui.ready(function() {
            var list = document.getElementById('list');
            list.style.height = (document.body.offsetHeight) + 'px';
            window.groupList = new mui.GroupList(list);
            //点击列表选择
            var ul_pet = document.getElementById('ul_pet');
            console.info("testr");
//            ul_pet.addEventListener("tap", function(e) {
            ul_pet.addEventListener("click", function(e) {
                var tagClass = e.target.getAttribute("class");
                console.log("tagClass==" + tagClass);
                if (tagClass && tagClass.indexOf("mui-table-view-cell") != -1) {
                    var selectPet = escape(e.target.innerHTML);
                    var selectPetId = e.target.value;
                    //window.location.href=ru+"?animalsId="+selectPetId+"&animalName="+selectPet+"&startDate="+startDate+"&endDate="+endDate+"&course_id="+course_id;
                    var url =ru+"?animalsId="+selectPetId+"&animalName="+selectPet;
                    if(requestParam!=null && typeof(requestParam)!='undefined'){
                    	for(var prop in requestParam){
                    		if(requestParam.hasOwnProperty(prop)){
                    			url +="&"+prop+"="+requestParam[prop];
                    		}
                    	}
                    }
                    window.location.href=url;
//                    alert("选择的宠物=" + selectPet);
//                    alert("选择的宠物=" + selectPetId);
//                    alert(ru);
                }
            });
        });

        $("#button_confirm").click(function(){
            $(".ui-dialog").hide();
        })
    });
</script>

</html>